{% extends "base.html" %}
{% load static from staticfiles %}
{% load bootstrap_tags %}

{% block head_js %}
<script  src="https://js.stripe.com/v2/"></script>
<script>
    //<![CDATA[
    Stripe.publishableKey = '{{ publishable }}';
    //]]>
</script>
<script type="text/javascript" src="{% static 'js/stripe.js' %}"></script>
{% endblock head_js %}

{% block content %}
<div class="cookie-block-checkout">
    {% for item in items_in_cart %}
        <div class="col-xs-4 col-sm-4 display panel-checkout panel-default text-center">
            <strong><p>{{ item.cookie.name }}</p></strong>
            <div class="panel-body">
                <div class="cookie-product-checkout" style="background-image: url('{{ MEDIA_URL }}{{ item.cookie.image }}')"></div>

                <div class="caption">
                    
                    <p class="cookie-info">{{ item.description }}</p>
                    <p class="text-center">Qty: {{ item.quantity }}
                    <br>({{ item.cookie.amount }} cookies per box)</p></br>
                    <p>{{ item.cookie.price }}</p>
                </div>
            </div>
            
        </div>
        
    {% endfor %}
        </div>
        <div class="text-center">
            <h4 class="total-checkout">Total</h4>
            <h4 class="total-checkout"><strong>{{ total }}</strong><span class="glyphicon glyphicon-euro" aria-hidden="true"></span></h4>
        
        </div>
        
        <form role="form" method="post" id="payment-form" action="{% url 'checkout' %}">
            <legend>Payment Details</legend>
        
            <div id="credit-card-errors" style="display: none;">
                <div id="alert-message block-message error" id="stripe-error-message"></div>
            </div>
        
            <div class="form-group col-md-6">
                {{ order_form | as_bootstrap }}
            </div>
        
            <div class="form-group col-md-6">
                {{ payment_form | as_bootstrap }}
            </div>
        
            {% csrf_token %}
            <div class="form-group col-md-12 text-center">
                <input class=" btn btn-warning" id="submit_payment_btn" name="commit" type="submit" value="Submit Payment">
            </div>
        </form>
{% endblock %}